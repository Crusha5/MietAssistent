<div class="modal fade" id="landlordModal" tabindex="-1" role="dialog" aria-modal="true" aria-labelledby="landlordModalTitle">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="landlordModalTitle">Vermieter anlegen</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="landlordForm">
                    <input type="hidden" id="landlord_id_field" name="landlord_id">
                    <div class="mb-3">
                        <label class="form-label">Vermieter-Typ *</label>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="type" id="type_natural" value="natural" checked>
                            <label class="form-check-label" for="type_natural">Natürliche Person</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="type" id="type_company" value="company">
                            <label class="form-check-label" for="type_company">Firma/Unternehmen</label>
                        </div>
                    </div>

                    <!-- Natürliche Person -->
                    <div id="naturalPersonFields">
                        <div class="row">
                            <div class="col-md-6">
                                <label for="first_name" class="form-label">Vorname *</label>
                                <input type="text" class="form-control" id="first_name" name="first_name" required>
                            </div>
                            <div class="col-md-6">
                                <label for="last_name" class="form-label">Nachname *</label>
                                <input type="text" class="form-control" id="last_name" name="last_name" required>
                            </div>
                        </div>
                        <div class="row mt-2">
                            <div class="col-md-6">
                                <label for="birth_date" class="form-label">Geburtsdatum</label>
                                <input type="date" class="form-control" id="birth_date" name="birth_date">
                            </div>
                            <div class="col-md-6">
                                <label for="tax_id" class="form-label">Steuer-ID</label>
                                <input type="text" class="form-control" id="tax_id" name="tax_id">
                            </div>
                        </div>
                    </div>

                    <!-- Firma -->
                    <div id="companyFields" style="display: none;">
                        <div class="row">
                            <div class="col-md-6">
                                <label for="company_name" class="form-label">Firmenname *</label>
                                <input type="text" class="form-control" id="company_name" name="company_name">
                            </div>
                            <div class="col-md-6">
                                <label for="legal_form" class="form-label">Rechtsform</label>
                                <select class="form-select" id="legal_form" name="legal_form">
                                    <option value="">Bitte auswählen...</option>
                                    <option value="GmbH">GmbH</option>
                                    <option value="KG">KG</option>
                                    <option value="OHG">OHG</option>
                                    <option value="GbR">GbR</option>
                                    <option value="Einzelunternehmer">Einzelunternehmer</option>
                                    <option value="andere">Andere</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mt-2">
                            <div class="col-md-6">
                                <label for="commercial_register" class="form-label">Handelsregister</label>
                                <input type="text" class="form-control" id="commercial_register" name="commercial_register">
                            </div>
                            <div class="col-md-6">
                                <label for="vat_id" class="form-label">USt-IdNr.</label>
                                <input type="text" class="form-control" id="vat_id" name="vat_id">
                            </div>
                        </div>
                        <div class="row mt-2">
                            <div class="col-12">
                                <label for="representative" class="form-label">Vertretungsberechtigte</label>
                                <input type="text" class="form-control" id="representative" name="representative" placeholder="Name der vertretungsberechtigten Person">
                            </div>
                        </div>
                    </div>

                    <!-- Adresse -->
                    <div class="mt-3">
                        <h6>Adresse</h6>
                        <div class="row">
                            <div class="col-md-6">
                                <label for="street" class="form-label">Straße *</label>
                                <input type="text" class="form-control" id="street" name="street" required>
                            </div>
                            <div class="col-md-3">
                                <label for="street_number" class="form-label">Hausnummer *</label>
                                <input type="text" class="form-control" id="street_number" name="street_number" required>
                            </div>
                            <div class="col-md-3">
                                <label for="zip_code" class="form-label">PLZ *</label>
                                <input type="text" class="form-control" id="zip_code" name="zip_code" required>
                            </div>
                        </div>
                        <div class="row mt-2">
                            <div class="col-md-6">
                                <label for="city" class="form-label">Ort *</label>
                                <input type="text" class="form-control" id="city" name="city" required>
                            </div>
                            <div class="col-md-6">
                                <label for="country" class="form-label">Land</label>
                                <input type="text" class="form-control" id="country" name="country" value="Deutschland">
                            </div>
                        </div>
                    </div>

                    <!-- Kontakt -->
                    <div class="mt-3">
                        <h6>Kontakt</h6>
                        <div class="row">
                            <div class="col-md-6">
                                <label for="phone" class="form-label">Telefon</label>
                                <input type="text" class="form-control" id="phone" name="phone">
                            </div>
                            <div class="col-md-6">
                                <label for="email" class="form-label">E-Mail</label>
                                <input type="email" class="form-control" id="email" name="email">
                            </div>
                        </div>
                        <div class="row mt-2">
                            <div class="col-12">
                                <label for="website" class="form-label">Website</label>
                                <input type="url" class="form-control" id="website" name="website">
                            </div>
                        </div>
                    </div>

                    <!-- Bankverbindung -->
                    <div class="mt-3">
                        <h6>Bankverbindung</h6>
                        <div class="row">
                            <div class="col-md-6">
                                <label for="bank_name" class="form-label">Bankname</label>
                                <input type="text" class="form-control" id="bank_name" name="bank_name">
                            </div>
                            <div class="col-md-6">
                                <label for="account_holder" class="form-label">Kontoinhaber</label>
                                <input type="text" class="form-control" id="account_holder" name="account_holder">
                            </div>
                        </div>
                        <div class="row mt-2">
                            <div class="col-md-6">
                                <label for="iban" class="form-label">IBAN</label>
                                <input type="text" class="form-control" id="iban" name="iban">
                            </div>
                            <div class="col-md-6">
                                <label for="bic" class="form-label">BIC</label>
                                <input type="text" class="form-control" id="bic" name="bic">
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Abbrechen</button>
                <button type="button" class="btn btn-primary" id="saveLandlord">Vermieter speichern</button>
            </div>
        </div>
    </div>
</div>
<script>
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('input[name="type"]').forEach(radio => {
        radio.addEventListener('change', function() {
            const isNatural = this.value === 'natural';
            document.getElementById('naturalPersonFields').style.display = isNatural ? 'block' : 'none';
            document.getElementById('companyFields').style.display = isNatural ? 'none' : 'block';
            document.getElementById('first_name').required = isNatural;
            document.getElementById('last_name').required = isNatural;
            document.getElementById('company_name').required = !isNatural;
        });
    });

    const landlordModal = document.getElementById('landlordModal');
    if (landlordModal) {
        landlordModal.addEventListener('hidden.bs.modal', function() {
            const form = document.getElementById('landlordForm');
            if (form) {
                form.reset();
            }
            document.getElementById('landlord_id_field').value = '';
            document.getElementById('type_natural').checked = true;
            document.getElementById('naturalPersonFields').style.display = 'block';
            document.getElementById('companyFields').style.display = 'none';
            const titleEl = landlordModal.querySelector('.modal-title');
            if (titleEl) titleEl.textContent = 'Vermieter anlegen';
        });
    }
});
</script>
